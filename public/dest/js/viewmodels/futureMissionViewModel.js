var FutureMissionViewModel=function(e,s){var t=this;t.missionSlug=ko.observable(e),t.launchDateTime=ko.observable(s),t.launchUnixSeconds=ko.observable(Date.parse(s)/1e3),t.secondsAwayFromLaunch=ko.observable(),t.requestIntervalFrequency=ko.observable(),t.webcast={isLive:ko.observable(),viewers:ko.observable(),status:ko.pureComputed(function(){return t.secondsAwayFromLaunch()<86400&&"true"==t.webcast.isLive()?"webcast-live":t.secondsAwayFromLaunch()<86400&&"false"==t.webcast.isLive()?"webcast-updates":"webcast-inactive"}),publicStatus:ko.pureComputed(function(){return"webcast-live"===t.webcast.status()?"Live Webcast":"webcast-updates"===t.webcast.status()?"Launch Updates":void 0}),publicViewers:ko.pureComputed(function(){return" ("+t.webcast.viewers()+" viewers)"})},t.days=ko.observable(),t.hours=ko.observable(),t.minutes=ko.observable(),t.seconds=ko.observable(),t.daysText=ko.observable(),t.hoursText=ko.observable(),t.minutesText=ko.observable(),t.secondsText=ko.observable(),t.requestWebcastStatus=function(){$.ajax("/webcast/getstatus",{dataType:"json",type:"POST",success:function(e){t.webcast.isLive(e.isLive),t.webcast.viewers(e.viewers)}})},t.requestLaunchDateTime=function(){$.ajax("/missions/"+t.missionSlug()+"/requestlaunchdatetime",{dataType:"json",type:"POST",success:function(e){t.launchDateTime()!==e.launchDateTime&&(t.launchDateTime(e.launchDateTime),t.launchUnixSeconds(Date.parse(e.launchDateTime)/1e3),t.setFrequency())}})},t.setFrequency=function(){var e=t.launchUnixSeconds()-Math.floor($.now()/1e3);1200>e&&"hypersonic"!==t.requestIntervalFrequency()?(t.requestIntervalFrequency("hypersonic"),t.setTimers(3e4)):3600>e&&e>=1200&&"supersonic"!==t.requestIntervalFrequency()?(t.requestIntervalFrequency("supersonic"),t.setTimers(6e4)):86400>e&&e>=3600&&"transonic"!==t.requestIntervalFrequency()?(t.requestIntervalFrequency("transonic"),t.setTimers(6e5)):e>=86400&&"subsonic"!==t.requestIntervalFrequency()&&(t.requestIntervalFrequency("subsonic"),t.setTimers(36e5))},t.setTimers=function(e){clearInterval(n),clearInterval(a),n=setInterval(t.requestLaunchDateTime,e),a=setInterval(t.requestWebcastStatus,e)},t.countdownProcessor=function(){var e=t.launchUnixSeconds(),s=Math.floor($.now()/1e3);if(s>=e)clearInterval(t.countdownTimer),t.zeroTimer();else{t.secondsAwayFromLaunch(e-s);var n=t.secondsAwayFromLaunch();t.days(Math.floor(n/86400)),n-=60*t.days()*60*24,t.hours(Math.floor(n/3600)),n-=60*t.hours()*60,t.minutes(Math.floor(n/60)),n-=60*t.minutes(),t.seconds(n),t.daysText(1==t.days()?"Day":"Days"),t.hoursText(1==t.hours()?"Hour":"Hours"),t.minutesText(1==t.minutes()?"Minute":"Minutes"),t.secondsText(1==t.seconds()?"Second":"Seconds"),t.setFrequency()}},t.zeroTimer=function(){t.days(0),t.hours(0),t.minutes(0),t.seconds(0),t.daysText("Days"),t.hoursText("Hours"),t.minutesText("Minutes"),t.secondsText("Seconds")};var n,a;t.setFrequency(),t.countdownProcessor(),t.requestWebcastStatus();setInterval(t.countdownProcessor,1e3)};